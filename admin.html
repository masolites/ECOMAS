 <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MASOLITES ECOMAS - Admin Panel</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* [All previous CSS remains unchanged] */
        /* Added new styles for escrow management */
        
        .escrow-form {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 15px;
        }
        
        .escrow-form .form-group {
            margin-bottom: 12px;
        }
        
        .escrow-form .full-width {
            grid-column: 1 / span 2;
        }
        
        .icon-selector {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 5px;
            margin-top: 5px;
        }
        
        .icon-option {
            padding: 8px;
            border: 1px solid var(--light-blue);
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
        }
        
        .icon-option.selected {
            background: var(--light-blue);
            color: var(--navy);
        }
        
        .fee-config {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
    </style>
</head>
<body>
    <div class="admin-container">
        <div class="admin-header">
            <!-- [Header unchanged] -->
        </div>
        
        <div class="admin-main">
            <!-- [Previous sections unchanged] -->
            
            <!-- Escrow Management Section -->
            <div class="admin-card">
                <h2 class="admin-card-title"><i class="fas fa-store"></i> Escrow Shop Management</h2>
                <p class="note">You can add up to 3 products/services</p>
                
                <div id="escrowProductsContainer">
                    <!-- Products will be loaded here -->
                </div>
                
                <button class="cta-button" id="addProductBtn" style="margin-top:15px;">
                    <i class="fas fa-plus"></i> Add Product
                </button>
            </div>
            
            <!-- Platform Fees Section -->
            <div class="admin-card">
                <h2 class="admin-card-title"><i class="fas fa-percentage"></i> Platform Fee Configuration</h2>
                <div class="fee-config">
                    <div class="form-group">
                        <label>Deposit Fee (%)</label>
                        <input type="number" id="depositFee" min="0" max="50" value="5">
                    </div>
                    <div class="form-group">
                        <label>Send Fee (%)</label>
                        <input type="number" id="sendFee" min="0" max="50" value="5">
                    </div>
                </div>
                <button class="update-btn" id="updateFeesBtn">
                    <i class="fas fa-save"></i> Update Fees
                </button>
            </div>
        </div>
    </div>

    <!-- Product Form Modal -->
    <div class="modal" id="productFormModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-box"></i> Product Details</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="productId">
                <div class="escrow-form">
                    <div class="form-group full-width">
                        <label>Product Name</label>
                        <input type="text" id="productName" required>
                    </div>
                    
                    <div class="form-group full-width">
                        <label>Description</label>
                        <textarea id="productDescription" rows="2"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>Price (₦)</label>
                        <input type="number" id="productPrice" min="0" step="0.01" required>
                    </div>
                    
                    <div class="form-group">
                        <label>Discount for Free Members (%)</label>
                        <input type="number" id="discountFree" min="0" max="100" value="0">
                    </div>
                    
                    <div class="form-group">
                        <label>Discount for Paid Members (%)</label>
                        <input type="number" id="discountPaid" min="0" max="100" value="10">
                    </div>
                    
                    <div class="form-group full-width">
                        <label>Select Icon</label>
                        <div class="icon-selector">
                            <div class="icon-option" data-icon="fas fa-tshirt"><i class="fas fa-tshirt"></i></div>
                            <div class="icon-option" data-icon="fas fa-laptop"><i class="fas fa-laptop"></i></div>
                            <div class="icon-option" data-icon="fas fa-mobile-alt"><i class="fas fa-mobile-alt"></i></div>
                            <div class="icon-option" data-icon="fas fa-book"><i class="fas fa-book"></i></div>
                            <div class="icon-option" data-icon="fas fa-tools"><i class="fas fa-tools"></i></div>
                            <div class="icon-option" data-icon="fas fa-car"><i class="fas fa-car"></i></div>
                            <div class="icon-option" data-icon="fas fa-home"><i class="fas fa-home"></i></div>
                            <div class="icon-option" data-icon="fas fa-utensils"><i class="fas fa-utensils"></i></div>
                            <div class="icon-option" data-icon="fas fa-gem"><i class="fas fa-gem"></i></div>
                            <div class="icon-option" data-icon="fas fa-heartbeat"><i class="fas fa-heartbeat"></i></div>
                        </div>
                        <input type="hidden" id="selectedIcon" value="fas fa-box">
                    </div>
                </div>
                
                <button class="cta-button" id="saveProductBtn">
                    <i class="fas fa-save"></i> Save Product
                </button>
            </div>
        </div>
    </div>

    <script>
        // Admin credentials
        const ADMIN_CREDENTIALS = {
            username: "admin",
            password: "Masolites123",
            pin: "123456"
        };
        
        // Initialize admin dashboard
        document.addEventListener('DOMContentLoaded', function() {
            // [Previous admin code unchanged]
            
            // Load escrow products
            function loadEscrowProducts() {
                const products = JSON.parse(localStorage.getItem('escrowProducts') || '[]');
                const container = document.getElementById('escrowProductsContainer');
                container.innerHTML = '';
                
                products.forEach((product, index) => {
                    const productCard = document.createElement('div');
                    productCard.className = 'card';
                    productCard.style.marginBottom = '15px';
                    productCard.style.position = 'relative';
                    
                    productCard.innerHTML = `
                        <div style="display:flex; align-items:center; gap:10px; margin-bottom:10px;">
                            <div style="font-size:1.5rem;"><i class="${product.icon}"></i></div>
                            <div>
                                <h4>${product.name}</h4>
                                <p>₦${product.price.toFixed(2)} | Free: ${product.discountFree}% | Paid: ${product.discountPaid}%</p>
                            </div>
                        </div>
                        <p>${product.description || 'No description'}</p>
                        <div style="position:absolute; top:10px; right:10px;">
                            <button class="action-btn" style="background:var(--light-blue);" data-id="${product.id}">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                            <button class="action-btn" style="background:var(--accent);" data-id="${product.id}">
                                <i class="fas fa-trash"></i> Delete
                            </button>
                        </div>
                    `;
                    
                    container.appendChild(productCard);
                });
                
                // Add event listeners to edit/delete buttons
                document.querySelectorAll('[data-id]').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const productId = this.dataset.id;
                        const action = this.querySelector('i').className.includes('edit') ? 'edit' : 'delete';
                        
                        if (action === 'edit') {
                            editProduct(productId);
                        } else {
                            if (confirm('Delete this product?')) {
                                deleteProduct(productId);
                            }
                        }
                    });
                });
            }
            
            // Edit product
            function editProduct(productId) {
                const products = JSON.parse(localStorage.getItem('escrowProducts') || '[]');
                const product = products.find(p => p.id == productId);
                
                if (product) {
                    document.getElementById('productId').value = product.id;
                    document.getElementById('productName').value = product.name;
                    document.getElementById('productDescription').value = product.description || '';
                    document.getElementById('productPrice').value = product.price;
                    document.getElementById('discountFree').value = product.discountFree;
                    document.getElementById('discountPaid').value = product.discountPaid;
                    document.getElementById('selectedIcon').value = product.icon;
                    
                    // Select icon
                    document.querySelectorAll('.icon-option').forEach(option => {
                        option.classList.remove('selected');
                        if (option.dataset.icon === product.icon) {
                            option.classList.add('selected');
                        }
                    });
                    
                    document.getElementById('productFormModal').style.display = 'flex';
                }
            }
            
            // Delete product
            function deleteProduct(productId) {
                let products = JSON.parse(localStorage.getItem('escrowProducts') || '[]');
                products = products.filter(p => p.id != productId);
                localStorage.setItem('escrowProducts', JSON.stringify(products));
                loadEscrowProducts();
            }
            
            // Add new product
            document.getElementById('addProductBtn').addEventListener('click', function() {
                document.getElementById('productId').value = '';
                document.getElementById('productName').value = '';
                document.getElementById('productDescription').value = '';
                document.getElementById('productPrice').value = '';
                document.getElementById('discountFree').value = 0;
                document.getElementById('discountPaid').value = 10;
                document.getElementById('selectedIcon').value = 'fas fa-box';
                
                // Reset icon selection
                document.querySelectorAll('.icon-option').forEach(option => {
                    option.classList.remove('selected');
                });
                
                document.getElementById('productFormModal').style.display = 'flex';
            });
            
            // Icon selection
            document.querySelectorAll('.icon-option').forEach(option => {
                option.addEventListener('click', function() {
                    document.querySelectorAll('.icon-option').forEach(opt => {
                        opt.classList.remove('selected');
                    });
                    this.classList.add('selected');
                    document.getElementById('selectedIcon').value = this.dataset.icon;
                });
            });
            
            // Save product
            document.getElementById('saveProductBtn').addEventListener('click', function() {
                const productId = document.getElementById('productId').value || Date.now();
                const name = document.getElementById('productName').value;
                const description = document.getElementById('productDescription').value;
                const price = parseFloat(document.getElementById('productPrice').value);
                const discountFree = parseInt(document.getElementById('discountFree').value);
                const discountPaid = parseInt(document.getElementById('discountPaid').value);
                const icon = document.getElementById('selectedIcon').value;
                
                if (!name || isNaN(price)) {
                    alert('Please fill in all required fields');
                    return;
                }
                
                let products = JSON.parse(localStorage.getItem('escrowProducts') || '[]');
                
                // Limit to 3 products
                if (!document.getElementById('productId').value && products.length >= 3) {
                    alert('Maximum of 3 products allowed');
                    return;
                }
                
                // Update or add product
                const existingIndex = products.findIndex(p => p.id == productId);
                const product = {
                    id: productId,
                    name,
                    description,
                    price,
                    discountFree,
                    discountPaid,
                    icon
                };
                
                if (existingIndex >= 0) {
                    products[existingIndex] = product;
                } else {
                    products.push(product);
                }
                
                localStorage.setItem('escrowProducts', JSON.stringify(products));
                loadEscrowProducts();
                document.getElementById('productFormModal').style.display = 'none';
            });
            
            // Update fees
            document.getElementById('updateFeesBtn').addEventListener('click', function() {
                const depositFee = parseInt(document.getElementById('depositFee').value);
                const sendFee = parseInt(document.getElementById('sendFee').value);
                
                if (isNaN(depositFee) || isNaN(sendFee)) {
                    alert('Please enter valid fee percentages');
                    return;
                }
                
                localStorage.setItem('platformFees', JSON.stringify({
                    deposit: depositFee,
                    send: sendFee
                }));
                
                this.innerHTML = '<i class="fas fa-check"></i> Fees Updated!';
                setTimeout(() => {
                    this.innerHTML = '<i class="fas fa-save"></i> Update Fees';
                }, 2000);
            });
            
            // Load escrow products on admin panel
            loadEscrowProducts();
        });
    </script>
</body>
</html>
